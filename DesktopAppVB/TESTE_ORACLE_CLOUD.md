# ?? Script de Teste - Conexão Oracle Cloud

## ? O Que Foi Corrigido

Identifiquei que você está usando **Oracle Cloud Autonomous Database** com Wallet!

### Mudanças Aplicadas:

1. ? **App.config** atualizado com credenciais corretas:
   - Data Source: `pontoofflinedb_tp`
- User: `TESTE_PONTO`
   - Password: `Medeixaempaz2001`
   - Wallet: `C:\Users\Guto\Downloads\Wallet_PontoOfflineDB`

2. ? **Module1.vb** atualizado com suporte a Oracle Cloud:
   - Novo tipo de conexão: `CLOUD`
   - Connection string com TNS_ADMIN e WALLET_LOCATION

---

## ?? Como Testar Agora

### Passo 1: Verificar Wallet

Certifique-se que o Wallet existe:
```powershell
Test-Path "C:\Users\Guto\Downloads\Wallet_PontoOfflineDB\tnsnames.ora"
Test-Path "C:\Users\Guto\Downloads\Wallet_PontoOfflineDB\sqlnet.ora"
```

**Deve retornar:** `True` para ambos

### Passo 2: Recompilar Projeto

```
Build ? Rebuild Solution (Ctrl+Shift+B)
```

### Passo 3: Executar Aplicação

```
Debug ? Start Debugging (F5)
```

**Esperado:** Mensagem "Conexão OK - Oracle Cloud (pontoofflinedb_tp)"

---

## ?? Se Ainda Houver Erro ORA-12154

### Solução 1: Verificar tnsnames.ora

Abra o arquivo:
```
C:\Users\Guto\Downloads\Wallet_PontoOfflineDB\tnsnames.ora
```

Deve conter algo como:
```
pontoofflinedb_tp = (description= (retry_count=20)(retry_delay=3)
  (address=(protocol=tcps)(port=1522)(host=adb.sa-saopaulo-1.oraclecloud.com))
  (connect_data=(service_name=xxx_pontoofflinedb_tp.adb.oraclecloud.com))
  (security=(ssl_server_cert_dn="CN=xxx")))
```

### Solução 2: Configurar Variável de Ambiente (Alternativa)

Se o erro persistir, configure globalmente:

```powershell
# PowerShell como Administrador
[System.Environment]::SetEnvironmentVariable("TNS_ADMIN", "C:\Users\Guto\Downloads\Wallet_PontoOfflineDB", "Machine")
[System.Environment]::SetEnvironmentVariable("ORACLE_HOME", "C:\Users\Guto\Downloads\Wallet_PontoOfflineDB", "Machine")
```

**Reinicie o Visual Studio** após executar.

---

## ?? Testar Manualmente a Conexão

### Via SQL Developer (Recomendado)

1. Abra **Oracle SQL Developer**
2. New Connection:
   - Connection Name: `PONTO_OFFLINE`
   - Username: `TESTE_PONTO`
   - Password: `Medeixaempaz2001`
   - Connection Type: **Cloud Wallet**
   - Configuration File: `C:\Users\Guto\Downloads\Wallet_PontoOfflineDB\Wallet_PontoOfflineDB.zip`
3. Test Connection

**Se funcionar:** VB.NET também funcionará!

### Via SQL*Plus (Terminal)

```powershell
cd C:\Users\Guto\Downloads\Wallet_PontoOfflineDB
sqlplus TESTE_PONTO/Medeixaempaz2001@pontoofflinedb_tp
```

---

## ?? Criar Tabelas de Teste

Após conectar, execute:

```sql
-- Criar tabela empresas
CREATE TABLE tb_empresas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  cnpj VARCHAR2(18) UNIQUE NOT NULL,
    razao_social VARCHAR2(255) NOT NULL,
    nome_fantasia VARCHAR2(255),
    insc_estadual VARCHAR2(20),
    endereco VARCHAR2(500),
    telefone VARCHAR2(20),
    email VARCHAR2(100),
    logo VARCHAR2(500)
);

-- Inserir dados de teste
INSERT INTO tb_empresas (cnpj, razao_social, nome_fantasia, email)
VALUES ('12345678000100', 'Empresa Teste LTDA', 'Teste Corp', 'teste@empresa.com');

COMMIT;

-- Verificar
SELECT * FROM tb_empresas;
```

---

## ? Checklist de Validação

### Antes de Rodar
- [ ] Wallet existe em `C:\Users\Guto\Downloads\Wallet_PontoOfflineDB`
- [ ] `tnsnames.ora` contém `pontoofflinedb_tp`
- [ ] App.config tem credenciais corretas
- [ ] Projeto compilou sem erros

### Ao Rodar
- [ ] Mensagem "Conexão OK - Oracle Cloud" aparece
- [ ] Formulário `frm_empresa` abre sem erro
- [ ] DataGridView carrega dados (se tabela existir)

### Se Erro ORA-50001
**Causa:** Conexão não abriu  
**Solução:** Verificar credenciais e Wallet

### Se Erro ORA-12154
**Causa:** TNS não resolvido  
**Solução:** 
1. Verificar `tnsnames.ora`
2. Configurar variável TNS_ADMIN
3. Reiniciar Visual Studio

---

## ?? Próximos Passos

### 1. Testar Conexão (Agora)
```
F5 ? Deve mostrar "Conexão OK"
```

### 2. Criar Tabelas (Se não existir)
```sql
-- Ver scripts acima
```

### 3. Testar CRUD
- Abrir `frm_empresa`
- Clicar "Novo"
- Cadastrar empresa
- Verificar se aparece no grid

---

## ?? Suporte

### Documentação Oracle Cloud
- [Autonomous Database Wallet](https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/connect-download-wallet.html)
- [ODP.NET e Cloud](https://www.oracle.com/database/technologies/appdev/dotnet/odp.html)

### Erros Comuns
| Erro | Solução |
|------|---------|
| ORA-12154 | Verificar tnsnames.ora e TNS_ADMIN |
| ORA-50001 | Credenciais incorretas |
| ORA-28000 | Conta bloqueada (tentar reset senha) |
| ORA-01017 | Senha incorreta |

---

**Status:** ? Código atualizado para Oracle Cloud  
**Próximo:** Testar conexão (F5)  
**Tempo:** ~2 minutos para validar

?? **Execute agora e veja a mágica acontecer!**
